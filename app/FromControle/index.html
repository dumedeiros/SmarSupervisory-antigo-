<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb" lang="en-gb" >
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="description" content="TheThemeBox Live Preview" />
        <meta name="generator" content="Joomla! - Open Source Content Management" />
        <title>Home</title>



        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/thumbs_style.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/slimbox.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/skitter.css'}" />

        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/mootools-core.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/core.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/caption.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/mootools-more.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/mootools-more.js'}"></script>

        <script type="text/javascript">
            window.addEvent('load', function() {
                new JCaption('img.caption');
            });
        </script>
        <script type="text/javascript" src="@{'public/javascripts/jquery-1.7.1.min.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/jquery.noconflict.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/slimbox.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/slimbox.js'}"></script>

        <!--<script src='js/jquery-1.5.2.min.js' type='text/javascript'></script>-->

        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/reset.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/template.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/nexus.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/css/other.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/stylesheets/form.css'}" />
        <link rel="stylesheet" media="screen" href="@{'public/stylesheets/buttons.css'}" />

        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/fontCss/openSans.css'}" />

        <style type="text/css">body{font-family:Arial, Helvetica, sans-serif }</style>
        <style type="text/css">h2{font-family:Open Sans }</style>
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/fontCss/openSans.css'}" />
        <style type="text/css">.module h3, .module_menu h3{font-family:Open Sans }</style>
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/fontCss/openSans.css'}" />
        <style type="text/css">#hornav{font-family:Open Sans }</style>
        <link rel="stylesheet" media="screen" href="@{'public/javascripts/PageStyle/fontCss/economica.css'}" />
        <style type="text/css">h1.logo-text a{font-family:Economica }</style>
        <!-- Hornav Dropdown -->
        <script type="text/javascript" src="@{'public/javascripts/PageStyle/js/dropdown.js'}"></script>


        <script type="text/javascript" src="@{'public/javascripts/Highstock-1.2.2/js/highstock.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/Highstock-1.2.2/js/modules/exporting.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/Highstock-1.2.2/js/gray.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/FusionWidgets/Charts/FusionCharts.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/Cylinder1.js'}" ></script>
        <script type="text/javascript" src="@{'public/javascripts/maskedinput-1.3.js'}"></script>
        <script type="text/javascript" src="@{'public/javascripts/util.js'}"></script>

        <style type="text/css">
            .notDisplayable{
                display: none;
            }
            .upDiv {
                width: 100px;
            }
            .setPointLabel {
                text-align: center;
            }
            #lnChart {
                width: 80%;
                float: left;
            }
            #tqChart {
                width: 20%;
                clip: rect(auto,auto,auto,auto);
                float: right;
            }

            .playIcon{
                background: transparent url("@{'public/images/play.png'}") no-repeat center top;
            }
            .playIcon:hover{
                background: transparent url("@{'public/images/playHover.png'}") no-repeat center top;
            }
            .playIcon:active{
                background: transparent url("@{'public/images/playActive.png'}") no-repeat center top;
            }

            .stopIcon{
                background: transparent url("@{'public/images/stop.png'}") no-repeat center top;
            }
            .stopIcon:hover{
                background: transparent url("@{'public/images/stopHover.png'}") no-repeat center top;
            }
            .stopIcon:active{
                background: transparent url("@{'public/images/stopActive.png'}") no-repeat center top;
            }

            .conectButton {
                width: 30px;
                height: 30px;
                margin: 0;
                padding: 0px;
                border: 0;
                text-indent: -1000em;
                cursor: pointer; /* hand-shaped cursor */
                cursor: hand; /* for IE 5.x */
            }

            .colorize{
                color: green;
            }

        </style>

        <script type="text/javascript" >
            window.addEvent('domready', function() {
                var myMenu = new MenuMatic();
            });
        </script>
    </head>
    <body> 
        <div class="notDisplayable">
            <input type="text" id="controlOutput" value="0.01"/>
            <input type="text" id="valorPV" value="0.01"/>
            <input type="text" id="valorTq2" value="0.01"/>
            <input type="text" id="valorTq1" value="0.01"/>
            <input type="text" id="ganhoP" value="0.01"/>
            <input type="text" id="ganhoI" value="0.01"/>
            <input type="text" id="ganhoD" value="0.01"/>
            <input type="text" id="ganhoPID" value="0.01"/>
        </div>
        <div id="container_header" class="container">
            <div class="wrapper960">
                <div id ="header" class="block_holder">
                    <div id="header_items">
                        <div id="socialmedia">
                        </div>	
                        <div id="logo">
                            <div class="logo_container">
                                <h1 class="logo"> 
                                    <a href="#" title="">
                                        <span></span>
                                    </a>
                                </h1>
                            </div>
                        </div>
                        <div class="clear"></div>
                        <div style="margin :  15px 0 0 210px;">
                            <form class="form2">
                                <div>
                                    <table class="">
                                        <tr>
                                            <td class="tableLabel"><label>IP</label></td>
                                            <td class="tableInput"><input type="text" class="noAnimated" name="ip" id="ip" value="localhost"/></td>
                                            <!--<td class="tableInput"><input type="text" class="noAnimated" name="ip" id="ip" value="10.13.99.69"/></td>-->
                                            <td  class="tableLabel"><label>PORTA</label></td>
                                            <td class="tableInput"><input type="text" class="noAnimated" name="porta" id="porta" value="20081"/></td>
                                            <td style="padding-left: 20px;"><button class="conectButton playIcon"id="conect"></button></td>
                                            <td style="width: 200px;" class="tableInput"><label id="statusConexao"></label><img id="loadIcon" class="notDisplayable" src="@{'public/images/load.gif'}"></img></td>
                                            <td><span></img></span></td>
                                        </tr>
                                    </table>
                                </div>

                            </form>
                            <p style="margin: 12px 0px 0px 180px;"><label>Informe os dados do controlador</label></p>
                        </div>
                    </div>
                    <div id="hornav">
                        <ul class="menu" id="moomenu">
                            <li class="item-482 deeper parent">
                                <a href="#">Malha</a>
                                <ul>
                                    <li class="item-483">
                                        <a href="#" id="maOp">Aberta</a>
                                    </li>
                                    <li class="item-497">
                                        <a href="#" id="mfOp">Fechada</a>
                                    </li>
                                    <li class="item-497">
                                        <a href="#" id="cascOp">Cascata</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
        </div>
        <div></div>
        <div id="container_slideshow_modules" class="container">
            <div class="wrapper960">
                <div id="slideshow_modules" class="block_holder">
                    <div id="wrapper_top-1" class="block_holder_margin">
                        <div class="top-1" style="width:33%;">
                            <div class="module_margin">
                                <div class="module">
                                    <div class="module_padding">
                                        <div class="module_header">
                                            <div style="margin-top: 45px">
                                                <div class="form" id="mlAberta" style="display: none; " >
                                                    <form style="margin: 30px 0 0 280px; padding: 0px">
                                                        <div>
                                                            <label for="onda">Tipo de Onda</label>
                                                            <select name="onda" id="onda">
                                                                <option value="0">Degrau</option>
                                                                <option value="1">Senoidal</option>
                                                                <option value="2">Cosseinoidal</option>
                                                                <option value="3">Quadrada</option>
                                                                <option value="4">Dente de Serra</option>
                                                                <option value="5">Aleatória</option>
                                                            </select>
                                                            <table class="maParamTable">
                                                                <tr>
                                                                    <td class="tableLabel"><label>Amplitude</label></td>
                                                                    <td class="tableInput"><input type="text" name="amp" id="amp" /></td>
                                                                    <td  class="tableLabel"><label>Periodo</label></td>
                                                                    <td class="tableInput"><input type="text" name="per" id="per" /></td>
                                                                    <td  class="tableLabel"><label>Offset</label></td>
                                                                    <td class="tableInput"><input type="text" name="offSet" id="offSet" /></td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="form" id="mlFechada">
                                                    <form style="margin: 30px 60px 0px 180px; padding: 0">
                                                        <div>
                                                            <p>
                                                                <label>SetPoint</label>
                                                                <input class="noAnimated changebleI" id="setPoint" value="15"></input>
                                                                <label style="margin-left: 100px">OverShoot:</label>
                                                                <label id="overShoot" class="labelColor">0.1</label>
                                                            </p>
                                                            <p>
                                                                <label>Sinal de Mestre</label>
                                                                <select name="sinRealim" id="sinRealim" class="changebleS">
                                                                    <option value="0">Tanque 1</option>
                                                                    <option value="1">Tanque 2</option>
                                                                    <option value="2">Saida 3</option>
                                                                    <option value="3">Saida 4</option>
                                                                    <option value="4">Saida 5</option>
                                                                    <option value="5">Saida 6</option>
                                                                    <option value="6">Saida 7</option>
                                                                    <option value="7">Saida 8</option>
                                                                </select>
                                                                <label style="margin-left: 85px">T. OverShoot:</label>
                                                                <label id="tOverShoot" class="labelColor">0.1</label>
                                                            </p>
                                                            <p class="cascata notDisplayable">
                                                                <label>Sinal de Escravo</label>
                                                                <select name="sinRealim" id="sinRealim2" class="changebleS">
                                                                    <option value="0">Tanque 1</option>
                                                                    <option value="1">Tanque 2</option>
                                                                    <option value="2">Saida 3</option>
                                                                    <option value="3">Saida 4</option>
                                                                    <option value="4">Saida 5</option>
                                                                    <option value="5">Saida 6</option>
                                                                    <option value="6">Saida 7</option>
                                                                    <option value="7">Saida 8</option>
                                                                </select>
                                                            </p>
                                                            <p>
                                                                <label>Controlador  </label>
                                                                <select name="contr" id="contrType" class="changebleS">
                                                                    <option value="0">P</option>
                                                                    <option value="1">PI</option>
                                                                    <option value="2">PD</option>
                                                                    <option value="3" selected="selected">PID</option>
                                                                    <option value="4">PI-D</option>
                                                                </select>
                                                                <label style="margin-left: 105px">T. Subida:</label>
                                                                <label id="tSubida" class="labelColor">0.1</label>
                                                            </p>
                                                            <p class="cascata notDisplayable">
                                                                <label>Controlador2</label>
                                                                <select name="contr" id="contrType2" class="changebleS">
                                                                    <option value="0">P</option>
                                                                    <option value="1">PI</option>
                                                                    <option value="2">PD</option>
                                                                    <option value="3" selected="selected">PID</option>
                                                                    <option value="4">PI-D</option>
                                                                </select>
                                                            </p>
                                                            <p>
                                                                <label for="integracao">Integração</label>
                                                                <select name="Itype" id="iType" class="changebleS">
                                                                    <option value="0"selected>N/A</option>
                                                                    <option value="1">Condicional</option>
                                                                    <option value="2">Anti-Reset-Windup</option>
                                                                </select>
                                                                <label style="margin-left: 28px">T. Acomodaçao:</label>
                                                                <label id="tAcomodacao" class="labelColor">0.1</label>
                                                            </p>
                                                            <p class="cascata notDisplayable">
                                                                <label for="integracao">Integração2</label>
                                                                <select name="Itype" id="iType2" class="changebleS">
                                                                    <option value="0"selected>N/A</option>
                                                                    <option value="1">Condicional</option>
                                                                    <option value="2">Anti-Reset-Windup</option>
                                                                </select>
                                                            </p>
                                                        </div>
                                                        <p>
                                                            <table class="mfParamTable">
                                                                <tr>
                                                                    <td class="tableLabel changebleI"><label>Kp</label></td>
                                                                    <td class="tableInput changebleI"><input name="kp" type="text" id="kp" value="1" /></td>
                                                                    <td  class="tableLabel changebleI"><label>Ki</label></td>
                                                                    <td class="tableInput changebleI"><input name="ki" type="text" id="ki" value="0.5" /></td>
                                                                    <td  class="tableLabel changebleI"><label>Kd</label></td>
                                                                    <td class="tableInput changebleI"><input name="kd" type="text" id="kd" value="0.005" /></td>
                                                                </tr>

                                                                <tr class="cascata notDisplayable">
                                                                    <td class="tableLabel changebleI"><label>Kp</label></td>
                                                                    <td class="tableInput changebleI"><input name="kp" type="text" id="kp2" value="1" /></td>
                                                                    <td  class="tableLabel changebleI"><label>Ki</label></td>
                                                                    <td class="tableInput changebleI"><input name="ki" type="text" id="ki2" value="0.5" /></td>
                                                                    <td  class="tableLabel changebleI"><label>Kd</label></td>
                                                                    <td class="tableInput changebleI"><input name="kd" type="text" id="kd2" value="0.005" /></td>
                                                                </tr>
                                                            </table>
                                                        </p>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="module_content">
                                            <div class="custom"  >
                                            </div>
                                        </div> 
                                    </div>
                                </div>
                            </div>
                        </div>                
                        <div class="top-1" style="width:67%;">
                            <div class="module_margin">
                                <div class="module">
                                    <div class="module_padding">
                                        <div class="module_content">
                                            <div class="clear"></div> 				
                                        </div> 
                                    </div>
                                </div>
                            </div>
                        </div>                                        
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="container_spacer2" class="container">
            <div class="wrapper960">
                <div class="clear"></div>
            </div>
        </div>
        <div id="container_main" class="container">
            <div class="wrapper960">
                <!--Setting up Layout for MainContent and Side Columns. Check to see if modules are enabled or disabled in the sidecolumns-->
                <div class="clear"></div>
            </div>
        </div>
        <div id="container_base" class="container">
            <div id="lnChart"></div>
            <div id="charts">
                <div id="lnChart2"></div>
                <div id="divTanq1" style="float: right"></div>
                <div id="divTanq2" style="float: right"></div>
            </div>
            <div id="paramChart"></div></div>
    </body> 
</html>
<script>
    
    
    
    var myTimer, isConnected = false, tipoMalha = 1;
    
    function change(t){
        if(isConnected){
            var timer;
            var x;
            if (x) { x.abort() } // If there is an existing XHR, abort it.
            clearTimeout(timer); // Clear the timer so we don't end up with dupes.
            timer = setTimeout(function() { // assign timer a new timeout 
                x = execute(); // run ajax request and store in x variable (so we can cancel)
            }, t); // 2000ms delay, tweak for faster/slower
        
        }
    }
    
    jQuery(".changebleI").keyup(function () {
        change(1000);
    });

    jQuery(".changebleS").change(function(event) {
        change(500);    
    });
    
    jQuery("body").keypress(function(event) {
        if ( event.which == KEYCODE_ENTER) {
            event.preventDefault(); 
            if(!isConnected){
                conect();
            }else{
                stop();
            }
        }
    });
    
    jQuery("#conect").click(function(){
        event.preventDefault(); 
        if(!isConnected){
            conect();
        }else{
            stop();
        }
    });

    function conect(){
        jQuery("#loadIcon").show();
        disableInput("#conect");
        jQuery("#statusConexao").text("Conectando");    
        jQuery.get("@{conect}", {ip : jQuery("#ip").val(), porta : jQuery("#porta").val() }, function(m){
            jQuery("#loadIcon").hide();
            enableInput("#conect");
            if(m != null){
                jQuery("#statusConexao").text("Conectado");
                jQuery("#conect").removeClass("playIcon");
                jQuery("#conect").addClass("stopIcon");
                isConnected = true;
                execute();
                
            }else{
                jQuery("#statusConexao").text("Erro na conexao");
                jQuery("#conect").removeClass("stopIcon");
                jQuery("#conect").addClass("playIcon");
                isConnected = false;
            }
        });
    }
    
    function stop(){
        clearInterval(myTimer);
        disableInput("#conect");
        jQuery("#statusConexao").text("Desconectando");
        jQuery.get("@{stop()}", function(){
            jQuery("#statusConexao").val("Desconectado");
            jQuery("#conect").removeClass("stopIcon");
            jQuery("#conect").addClass("playIcon");
            enableInput("#conect");
            jQuery("#statusConexao").text("Desconectado");    
            isConnected = false;
        });
    }
    
    
    function execute(){
        if(tipoMalha == 0 ){
            runMAberta();
        }else if(tipoMalha == 1) {
            runMFechada();
        }else{
            runCascata();
        }
        clearInterval(myTimer);
        setUpInterval();
    }
    
    function runCascata(){
        jQuery.get("@{Cascata.execute()}", {
            sr : jQuery("#sinRealim").val(), 
            sr2 : jQuery("#sinRealim2").val(), 
            kp : jQuery("#kp").val(), 
            ki : jQuery("#ki").val(), 
            kd : jQuery("#kd").val(), 
            kp2 : jQuery("#kp2").val(), 
            ki2 : jQuery("#ki2").val(), 
            kd2 : jQuery("#kd2").val(), 
            setPoint : jQuery("#setPoint").val(), 
            iType: jQuery("#iType").val(), 
            iType2: jQuery("#iType2").val(), 
            contrType : jQuery("#contrType").val(),
            contrType2 : jQuery("#contrType2").val()
        });
    }
    
    function runMFechada(){
        jQuery.get("@{MalhaFechada.execute()}", {
            sr : jQuery("#sinRealim").val(), 
            kp : jQuery("#kp").val(), 
            ki : jQuery("#ki").val(), 
            kd : jQuery("#kd").val(), 
            setPoint : jQuery("#setPoint").val(), 
            iType: jQuery("#iType").val(), 
            contrType : jQuery("#contrType").val()
        });
    }
    
    
    function runMAberta(){
        jQuery.get("@{MalhaAberta.execute()}", {
            tipo : jQuery("#onda").val(), 
            amp : jQuery("#amp").val(), 
            per : jQuery("#per").val(), 
            offSet : jQuery("#offSet").val()
        });
    }
    
    function feedGraph()
    {
        if(tipoMalha == 1){
            jQuery.getJSON("@{MalhaFechada.getValues()}", function
            (systemData) {
                //                console.log(pid.tacomodacao)
                jQuery("#controlOutput").val(systemData.controlOutput);
                jQuery("#valorTq2").val(systemData.valorTq2);
                jQuery("#valorTq1").val(systemData.valorTq1);
                jQuery("#ganhoP").val(systemData.ganhoP);
                jQuery("#ganhoI").val(systemData.ganhoI);
                jQuery("#ganhoD").val(systemData.ganhoD);
                jQuery("#ganhoPID").val(systemData.ganhoPID);
                //                jQuery("#valorPV").val(systemData.valorPV)

                ovs = systemData.percenOvshoot.toFixed(3)
                tovs = systemData.tOvershoot;
                tsub = systemData.tSubida;
                tAcom = systemData.tAcomodacao;
                if(ovs == 0){
                    jQuery("#overShoot").removeClass("colorize");
                }else{
                    jQuery("#overShoot").addClass("colorize");
                }
                jQuery("#overShoot").text(ovs);
                
                if(tovs == 0){
                    jQuery("#tOverShoot").removeClass("colorize");
                }else{
                    jQuery("#tOverShoot").addClass("colorize");
                }
                jQuery("#tOverShoot").text(tovs);
                
                if(tsub == 0){
                    jQuery("#tSubida").removeClass("colorize");
                }else{
                    jQuery("#tSubida").addClass("colorize");
                }
                jQuery("#tSubida").text(tsub);
                
                if(tAcom == 0){
                    jQuery("#tAcomodacao").removeClass("colorize");
                }else{
                    jQuery("#tAcomodacao").addClass("colorize");
                }
                jQuery("#tAcomodacao").text(tAcom);
            })
        }else if (tipoMalha == 2){
            jQuery.getJSON("@{Cascata.getValues()}", function
            (systemData) {
                jQuery("#controlOutput").val(systemData.controlOutput);
                jQuery("#valorTq2").val(systemData.valorTq2);
                jQuery("#valorTq1").val(systemData.valorTq1);
//                jQuery("#ganhoP").val(systemData.ganhoP);
//                jQuery("#ganhoI").val(systemData.ganhoI);
//                jQuery("#ganhoD").val(systemData.ganhoD);
//                jQuery("#ganhoPID").val(systemData.ganhoPID);
//                ovs = systemData.percenOvshoot.toFixed(3)
//                tovs = systemData.tOvershoot;
//                tsub = systemData.tSubida;
//                tAcom = systemData.tAcomodacao;
//                jQuery("#overShoot").text(ovs);
//                jQuery("#tOverShoot").text(tovs);
//                jQuery("#tSubida").text(tsub);
//                jQuery("#tAcomodacao").text(tAcom);
            })
        }else {
            jQuery.getJSON("@{MalhaAberta.getValues()}", function(systemData) {
                jQuery("#controlOutput").val(systemData.controlOutput);
                jQuery("#valorTq2").val(systemData.valorTq2);
                jQuery("#valorTq1").val(systemData.valorTq1);
            })
        }
    }
    
    jQuery("#maOp").click(function(){
        tipoMalha = 0;
        jQuery("#setPoint").val(0);
        jQuery("#mlFechada").hide();
        jQuery("#mlAberta").show();
    });
    
    jQuery("#mfOp").click(function(){
        tipoMalha = 1;
        jQuery("#setPoint").val(15);
        jQuery("#mlAberta").hide();
        jQuery("#mlFechada").show();
        jQuery(".cascata").hide();
    });
    
    jQuery("#cascOp").click(function(){
        tipoMalha = 2;
        jQuery(".cascata").show();
        jQuery("#setPoint").val(15);
        jQuery("#mlAberta").hide();
        jQuery("#mlFechada").show();
    });
    
    jQuery("#contrType").change(function(){
        var id = jQuery(this).val();
        switch(id){
            case "0":
                disableInput("#kd");
                disableInput("#ki");
                break;
            case "1":
                enableInput("#ki");
                disableInput("#kd");
                break;
            case "2":
                enableInput("#kd");
                disableInput("#ki");
                break;
            case "3":
                enableInput("#kd");
                enableInput("#ki");
                break;
        }
    });
    
    function setUpInterval(){
        var setPoint = chart.series[0];//HighStockChart
        var nvTq1 = chart.series[1];//HighStockChart
        var nvTq2 = chart.series[2];//HighStockChart
        
        var outroGrafico = chart2.series[0];//HighStockChart
        var ganhoP = chart2.series[1];//HighStockChart
        var ganhoI = chart2.series[2];//HighStockChart
        var ganhoD = chart2.series[3];//HighStockChart
        var ganhoPID = chart2.series[4];//HighStockChart
        
        myTimer = setInterval(function() {
            feedGraph();
            var x = (new Date()).getTime(),
            //                    y = Math.round
            //            (Math.random() * 100);
            a = jQuery("#controlOutput").val()/1;
            b = jQuery("#valorTq1").val()/1;
            c = jQuery("#valorTq2").val()/1;
            sp = jQuery("#setPoint").val()/1;
            console.log(jQuery("#setPoint").val()/1);
            
            p = jQuery("#ganhoP").val()/1;
            i = jQuery("#ganhoI").val()/1;
            d = jQuery("#ganhoD").val()/1;
            pid = jQuery("#ganhoPID").val()/1;
            
            nvTq1.addPoint([x, b], true, true);
            setPoint.addPoint([x, sp], true, true);
            nvTq2.addPoint([x, c], true, true);
            outroGrafico.addPoint([x, a], true, true);
            ganhoP.addPoint([x, p], true, true);
            ganhoI.addPoint([x, i], true, true);
            ganhoD.addPoint([x, d], true, true);
            ganhoPID.addPoint([x, pid], true, true);
            //----------------------------------------------------
            var chartReference = FusionCharts("tanq1"); 
            var chartReference2 = FusionCharts("tanq2"); 
            chartReference.feedData("&value=" + b);
            chartReference2.feedData("&value=" + c);
            //            chartReference.setChartAttribute({"value" : b});
            //                    chart2.redraw();
        }, 600);
    }
    
    function putColor(){
        jQuery(".labelColor").each(function(){
            val = jQuery(this).text();
            if(val == 0){
                jQuery(this).removeClass("colorize");
            }else{
                jQuery(this).addClass("colorize");
            }
        });
    }
    
    FusionCharts.setCurrentRenderer('javascript');
    var chart = new FusionCharts("@{'public/javascripts/FusionWidgets/Charts/Cylinder.swf'}", "tanq1", "120", "320", "0", "1" );
    chart.setXMLData( dataString );
    chart.render("divTanq2");
        
    var chart2 = new FusionCharts("@{'public/javascripts/FusionWidgets/Charts/Cylinder.swf'}", "tanq2", "120", "320", "0", "1" );
    chart2.setXMLData( dataString );
    chart2.render("divTanq1");


    chart = new Highcharts.StockChart({
        chart : {
            renderTo : 'lnChart',
            shadow : true,
            alignTicks : true,
            animation : false
        },
        title : {
            text : 'Sinais'
        },
        legend: {
            enabled: true,
            align: 'left',
            floating : true,
            layout: 'horizontal',
            verticalAlign: 'top'
        },
        exporting: {
            enable : true
        },
        rangeSelector: {
            buttons: [{
                    count: 1,
                    type: 'minute',
                    text: '1M'
                }, {
                    count: 5,
                    type: 'minute',
                    text: '5M'
                }, {
                    type: 'all',
                    text: 'All'
                }],
            inputEnabled: false,
            selected: 0
        },
        credits:{
            enable : true,
            text : ""
        },
        series : [
            {
                name : 'Set Point',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            },
            {
                name : 'Tq1',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            },
            {
                name : 'Tq2',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            }   
        ]
    });
                
    chart2 = new Highcharts.StockChart({
        chart : {
            renderTo : 'paramChart',
            plotShadow : true,
            shadow : true,
            //                    alignTicks : true,
            //                    borderWidht : '5px',
            //                    borderRadius : '5',
            height : '320',
            animation : false
        },
        legend: {
            enabled: true,
            align: 'left',
            //                        backgroundColor: '#FCFFC5',
            //                        borderColor: 'black',
            //                        borderWidth: 2,
            floating : true,
            layout: 'horizontal',
            verticalAlign: 'top'
            //                        y: 100,
            //                        shadow: true
            /*labelFormatter: function() {
                            return this.name + ' (T)';
                        }*/

        },
        //                    legend: {
        //                        layout: 'vertical',
        //                        borderWidth: 1,
        //                        shadow: true,
        //                        style: {
        //                            left: 'auto',
        //                            bottom: 'auto',
        //                            right: '10px',
        //                            top: '100px'
        //                        }
        //                    },
        credits:{
            enable : true,
            text : ""
        },
        rangeSelector: {
            buttons: [{
                    count: 1,
                    type: 'minute',
                    text: '1M'
                }, {
                    count: 5,
                    type: 'minute',
                    text: '5M'
                }, {
                    type: 'all',
                    text: 'All'
                }],
            inputEnabled: false,
            selected: 0
        },
		
        title : {
            text : 'Sinais'
        },
		
        exporting: {
            enabled: false
                    
        },
        labels : {
            style : {
                color : "000000"
            }
        },
                
        series : [{
                name : 'Sinal 1',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            },
            {
                name : 'P',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            },
            {
                name : 'I',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            },   
            {
                name : 'D',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            },
            {
                name : 'PID',
                data : (function() {
                    // generate an array of random data
                    var data = [], time = (new Date()).getTime(), i;

                    for( i = -299; i <= 0; i++) {
                        data.push([
                            time + i * 1000,
                            0
                        ]);
                    }
                    return data;
                })()
            }
        ]
    });
    
    
    
</script>